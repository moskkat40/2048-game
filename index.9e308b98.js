const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.grid=t,this.score=0,this.status="idle"}moveLeft(){let t=!1;for(let e=0;e<this.grid.length;e++){let i=this.grid[e].filter(t=>t>0);for(let e=0;e<i.length-1;e++)i[e]===i[e+1]&&(i[e]*=2,i[e+1]=0,this.score+=i[e],t=!0);for(i=i.filter(t=>0!==t);i.length<4;)i.push(0);this.grid[e].toString()!==i.toString()&&(t=!0),this.grid[e]=i}this.updateDOM(),this.checkWin()||(t&&this.addStartCell(),this.checkLose())}moveRight(){let t=!1;for(let e=0;e<this.grid.length;e++){let i=this.grid[e].filter(t=>t>0);for(let e=i.length-1;e>0;e--)i[e]===i[e-1]&&(i[e]*=2,i[e-1]=0,this.score+=i[e],t=!0);for(i=i.filter(t=>0!==t);i.length<4;)i.unshift(0);this.grid[e].toString()!==i.toString()&&(t=!0),this.grid[e]=i}this.updateDOM(),this.checkWin()||(t&&this.addStartCell(),this.checkLose())}moveUp(){let t=!1;for(let e=0;e<this.grid[0].length;e++){let i=[];for(let t=0;t<this.grid.length;t++)this.grid[t][e]>0&&i.push(this.grid[t][e]);for(let e=0;e<i.length-1;e++)i[e]===i[e+1]&&(i[e]*=2,i[e+1]=0,this.score+=i[e],t=!0);for(i=i.filter(t=>0!==t);i.length<4;)i.push(0);for(let s=0;s<this.grid.length;s++)this.grid[s][e]!==i[s]&&(t=!0),this.grid[s][e]=i[s]}this.updateDOM(),this.checkWin()||(t&&this.addStartCell(),this.checkLose())}moveDown(){let t=!1;for(let e=0;e<this.grid.length;e++){let i=[];for(let t=0;t<this.grid.length;t++)this.grid[t][e]>0&&i.push(this.grid[t][e]);for(let e=i.length-1;e>0;e--)i[e]===i[e-1]&&(i[e]*=2,i[e-1]=0,this.score+=i[e],t=!0);for(i=i.filter(t=>0!==t);i.length<4;)i.unshift(0);for(let s=0;s<this.grid.length;s++)this.grid[s][e]!==i[s]&&(t=!0),this.grid[s][e]=i[s]||0}this.updateDOM(),this.checkWin()||(t&&this.addStartCell(),this.checkLose())}checkWin(){for(let t=0;t<this.grid.length;t++)for(let e=0;e<this.grid[t].length;e++)if(2048===this.grid[t][e])return this.status="win",!0;return this.status="playing",!1}getScore(){return this.score}getState(){return this.grid}getStatus(){return this.status}start(){this.grid=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="playing",this.updateDOM(),this.addStartCell(),this.addStartCell()}restart(){document.querySelectorAll(".field-cell").forEach(t=>{t.innerHTML="",t.className="field-cell"}),this.grid=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle",this.updateDOM()}addStartCell(){let t=Math.random()>=.9?4:2;if(0===this.grid.flat().filter(t=>0===t).length)return;let e=!1;for(;!e;)try{let i=Math.floor(4*Math.random()),s=Math.floor(4*Math.random());this.grid[i]&&0===this.grid[i][s]&&(this.grid[i][s]=t,this.updateDOM(),e=!0)}catch(t){return}}updateDOM(){let t=document.querySelectorAll(".field-cell");for(let e=0;e<this.grid.length;e++)for(let i=0;i<this.grid[e].length;i++){let s=t[4*e+i],r=this.grid[e][i];s.className="field-cell",s.innerHTML="",r>0&&(s.classList.add(`field-cell--${r}`),s.innerHTML=r)}}checkLose(){for(let t=0;t<this.grid.length;t++)for(let e=0;e<this.grid[t].length;e++)if(0===this.grid[t][e])return this.status="playing",!1;for(let t=0;t<this.grid.length;t++)for(let e=0;e<this.grid[t].length;e++)if(t>0&&this.grid[t][e]===this.grid[t-1][e]||t<this.grid.length-1&&this.grid[t][e]===this.grid[t+1][e]||e>0&&this.grid[t][e]===this.grid[t][e-1]||e<this.grid[t].length-1&&this.grid[t][e]===this.grid[t][e+1])return this.status="playing",!1;return this.status="lose",!0}},e=document.querySelector(".button.start"),i=document.querySelector(".message.message-start"),s=document.querySelector(".message.message-lose"),r=document.querySelector(".message.message-win"),h=document.querySelector(".game-score");document.addEventListener("keydown",e=>{switch(e.key){case"ArrowLeft":t.moveLeft(),h.innerText=t.score;break;case"ArrowRight":t.moveRight(),h.innerText=t.score;break;case"ArrowUp":t.moveUp(),h.innerText=t.score;break;case"ArrowDown":t.moveDown(),h.innerText=t.score}"lose"===t.getStatus()&&(s.classList.remove("hidden"),i.classList.add("hidden")),"win"===t.getStatus()&&(r.classList.remove("hidden"),i.classList.add("hidden"))}),e.addEventListener("click",()=>{e.classList.contains("restart")?(e.classList.replace("restart","start"),e.innerHTML="Start",i.classList.remove("hidden"),s.classList.add("hidden"),h.innerText=0,t.restart()):(e.classList.replace("start","restart"),e.innerHTML="Restart",t.start(),i.classList.add("hidden"),s.classList.add("hidden"))});
//# sourceMappingURL=index.9e308b98.js.map
